[32m2025-04-15 22:14:18 +0000[0m - dagster - [34mDEBUG[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - 84878 - LOGS_CAPTURED - Started capturing logs in process (pid: 84878).
[32m2025-04-15 22:14:18 +0000[0m - dagster - [34mDEBUG[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - 84878 - internal_optimal_cluster_counts - STEP_START - Started execution of step "internal_optimal_cluster_counts".
[32m2025-04-15 22:14:18 +0000[0m - dagster - [34mDEBUG[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Loading file from: storage/internal_dimensionality_reduced_features using PickledObjectFilesystemIOManager...
[32m2025-04-15 22:14:18 +0000[0m - dagster - [34mDEBUG[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - 84878 - internal_optimal_cluster_counts - LOADED_INPUT - Loaded input "internal_dimensionality_reduced_features" using input manager "io_manager", from output "result" of step "internal_dimensionality_reduced_features"
[32m2025-04-15 22:14:18 +0000[0m - dagster - [34mDEBUG[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - 84878 - internal_optimal_cluster_counts - STEP_INPUT - Got input "internal_dimensionality_reduced_features" of type "Dict[String,DataFrame]". (Type check passed).
[32m2025-04-15 22:14:18 +0000[0m - dagster - [34mINFO[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Determining optimal clusters using range 2-10 with metrics: ['silhouette', 'calinski_harabasz', 'davies_bouldin']
[32m2025-04-15 22:14:18 +0000[0m - dagster - [34mINFO[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Determining optimal cluster count for category: PERSONAL CARE
[32m2025-04-15 22:14:19 +0000[0m - dagster - [34mWARNING[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Category 'PERSONAL CARE' has only 2 samples. Reducing max_clusters from 10 to 1.
[32m2025-04-15 22:14:19 +0000[0m - dagster - [34mWARNING[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Category 'PERSONAL CARE' has too few samples (2) to evaluate clusters in range [2, 10]. Setting optimal clusters to 1.
[32m2025-04-15 22:14:19 +0000[0m - dagster - [34mINFO[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Determining optimal cluster count for category: BABY CARE
[32m2025-04-15 22:14:19 +0000[0m - dagster - [34mWARNING[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Category 'BABY CARE' has only 2 samples. Reducing max_clusters from 10 to 1.
[32m2025-04-15 22:14:19 +0000[0m - dagster - [34mWARNING[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Category 'BABY CARE' has too few samples (2) to evaluate clusters in range [2, 10]. Setting optimal clusters to 1.
Exception while writing logger call to event log: (sqlite3.OperationalError) database is locked
[SQL: INSERT INTO event_logs (run_id, event, dagster_event_type, timestamp, step_key, asset_key, partition) VALUES (?, ?, ?, ?, ?, ?, ?)]
[parameters: ('5336fe68-6c95-4469-b1d4-2b56bfa3e3a4', '{"__class__": "EventLogEntry", "dagster_event": null, "error_info": null, "level": 20, "message": "", "pipeline_name": "internal_ml_job", "run_id": " ... (46 characters truncated) ... ey": "internal_optimal_cluster_counts", "timestamp": 1744755259.0903094, "user_message": "Determining optimal cluster count for category: HOME CARE"}', None, '2025-04-15 22:14:19.090309', 'internal_optimal_cluster_counts', None, None)]
(Background on this error at: https://sqlalche.me/e/14/e3q8)
[32m2025-04-15 22:14:29 +0000[0m - dagster - [34mINFO[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Determining optimal cluster count for category: HOME CARE
[32m2025-04-15 22:14:29 +0000[0m - dagster - [34mWARNING[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Category 'HOME CARE' has only 2 samples. Reducing max_clusters from 10 to 1.
[32m2025-04-15 22:14:29 +0000[0m - dagster - [34mWARNING[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Category 'HOME CARE' has too few samples (2) to evaluate clusters in range [2, 10]. Setting optimal clusters to 1.
[32m2025-04-15 22:14:29 +0000[0m - dagster - [34mINFO[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Determining optimal cluster count for category: ADULT CARE
[32m2025-04-15 22:14:29 +0000[0m - dagster - [34mWARNING[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Category 'ADULT CARE' has only 2 samples. Reducing max_clusters from 10 to 1.
[32m2025-04-15 22:14:29 +0000[0m - dagster - [34mWARNING[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Category 'ADULT CARE' has too few samples (2) to evaluate clusters in range [2, 10]. Setting optimal clusters to 1.
[32m2025-04-15 22:14:29 +0000[0m - dagster - [34mINFO[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Determining optimal cluster count for category: MEDICATION
[32m2025-04-15 22:14:29 +0000[0m - dagster - [34mWARNING[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Category 'MEDICATION' has only 2 samples. Reducing max_clusters from 10 to 1.
[32m2025-04-15 22:14:29 +0000[0m - dagster - [34mWARNING[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Category 'MEDICATION' has too few samples (2) to evaluate clusters in range [2, 10]. Setting optimal clusters to 1.
[32m2025-04-15 22:14:29 +0000[0m - dagster - [34mINFO[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Determining optimal cluster count for category: NUTRITION
[32m2025-04-15 22:14:29 +0000[0m - dagster - [34mWARNING[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Category 'NUTRITION' has only 2 samples. Reducing max_clusters from 10 to 1.
[32m2025-04-15 22:14:29 +0000[0m - dagster - [34mWARNING[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Category 'NUTRITION' has too few samples (2) to evaluate clusters in range [2, 10]. Setting optimal clusters to 1.
[32m2025-04-15 22:14:29 +0000[0m - dagster - [34mINFO[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Determining optimal cluster count for category: BEAUTY
[32m2025-04-15 22:14:29 +0000[0m - dagster - [34mWARNING[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Category 'BEAUTY' has only 2 samples. Reducing max_clusters from 10 to 1.
[32m2025-04-15 22:14:29 +0000[0m - dagster - [34mWARNING[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Category 'BEAUTY' has too few samples (2) to evaluate clusters in range [2, 10]. Setting optimal clusters to 1.
[32m2025-04-15 22:14:29 +0000[0m - dagster - [34mDEBUG[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - 84878 - internal_optimal_cluster_counts - STEP_OUTPUT - Yielded output "result" of type "Dict[String,Int]". (Type check passed).
[32m2025-04-15 22:14:29 +0000[0m - dagster - [34mDEBUG[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - internal_optimal_cluster_counts - Writing file at: storage/internal_optimal_cluster_counts using PickledObjectFilesystemIOManager...
[32m2025-04-15 22:14:29 +0000[0m - dagster - [34mDEBUG[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - 84878 - internal_optimal_cluster_counts - ASSET_MATERIALIZATION - Materialized value internal_optimal_cluster_counts.
[32m2025-04-15 22:14:29 +0000[0m - dagster - [34mDEBUG[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - 84878 - internal_optimal_cluster_counts - HANDLED_OUTPUT - Handled output "result" using IO manager "io_manager"
[32m2025-04-15 22:14:29 +0000[0m - dagster - [34mDEBUG[0m - internal_ml_job - 5336fe68-6c95-4469-b1d4-2b56bfa3e3a4 - 84878 - internal_optimal_cluster_counts - STEP_SUCCESS - Finished execution of step "internal_optimal_cluster_counts" in 10.69s.
