[32m2025-04-14 05:37:45 +0000[0m - dagster - [34mDEBUG[0m - internal_preprocessing_job - 92153196-eeaf-43b3-9e2b-bfef8c85a940 - 6393 - LOGS_CAPTURED - Started capturing logs in process (pid: 6393).
[32m2025-04-14 05:37:45 +0000[0m - dagster - [34mDEBUG[0m - internal_preprocessing_job - 92153196-eeaf-43b3-9e2b-bfef8c85a940 - 6393 - internal_product_category_mapping - STEP_START - Started execution of step "internal_product_category_mapping".
[32m2025-04-14 05:37:46 +0000[0m - dagster - [34mINFO[0m - internal_preprocessing_job - 92153196-eeaf-43b3-9e2b-bfef8c85a940 - internal_product_category_mapping - Successfully read mapping data with shape: (7, 14)
[32m2025-04-14 05:37:46 +0000[0m - dagster - [34mINFO[0m - internal_preprocessing_job - 92153196-eeaf-43b3-9e2b-bfef8c85a940 - internal_product_category_mapping - Columns: ['PRODUCT_ID', 'CATEGORY', 'NEED_STATE', 'CDT', 'ATTRIBUTE_1', 'ATTRIBUTE_2', 'ATTRIBUTE_3', 'ATTRIBUTE_4', 'ATTRIBUTE_5', 'ATTRIBUTE_6', 'PLANOGRAM_DSC', 'PLANOGRAM_NBR', 'NEW_ITEM', 'TO_BE_DROPPED']
[32m2025-04-14 05:37:46 +0000[0m - dagster - [34mINFO[0m - internal_preprocessing_job - 92153196-eeaf-43b3-9e2b-bfef8c85a940 - internal_product_category_mapping - Sample data: shape: (2, 14)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PRODUCT_ID â”† CATEGORY â”† NEED_STATE â”† CDT  â”† â€¦ â”† PLANOGRAM_D â”† PLANOGRAM_ â”† NEW_ITEM â”† TO_BE_DROP â”‚
â”‚ ---        â”† ---      â”† ---        â”† ---  â”†   â”† SC          â”† NBR        â”† ---      â”† PED        â”‚
â”‚ i64        â”† str      â”† str        â”† str  â”†   â”† ---         â”† ---        â”† bool     â”† ---        â”‚
â”‚            â”†          â”†            â”†      â”†   â”† str         â”† i64        â”†          â”† str        â”‚
â•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•ªâ•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ 1001       â”† Grocery  â”† Dairy      â”† Food â”† â€¦ â”† Standard    â”† 1001       â”† false    â”† FALSE      â”‚
â”‚            â”†          â”†            â”†      â”†   â”† Dairy       â”†            â”†          â”†            â”‚
â”‚ 1002       â”† Grocery  â”† Bakery     â”† Food â”† â€¦ â”† Standard    â”† 1002       â”† false    â”† FALSE      â”‚
â”‚            â”†          â”†            â”†      â”†   â”† Bakery      â”†            â”†          â”†            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
[32m2025-04-14 05:37:46 +0000[0m - dagster - [34mDEBUG[0m - internal_preprocessing_job - 92153196-eeaf-43b3-9e2b-bfef8c85a940 - 6393 - internal_product_category_mapping - STEP_OUTPUT - Yielded output "result" of type "NSMappingSchema". Warning! Type check failed.
[32m2025-04-14 05:37:46 +0000[0m - dagster - [34mERROR[0m - [31minternal_preprocessing_job - 92153196-eeaf-43b3-9e2b-bfef8c85a940 - 6393 - internal_product_category_mapping - STEP_FAILURE - Execution of step "internal_product_category_mapping" failed.

dagster._core.errors.DagsterTypeCheckDidNotPass: Type check failed for step output "result" - expected type "NSMappingSchema". Description: {
    "DATA": {
        "DATATYPE_COERCION": [
            {
                "schema": "NSMappingSchema",
                "column": "NSMappingSchema",
                "check": "coerce_dtype('{'PRODUCT_ID': DataType(Int64), 'CATEGORY': DataType(String), 'NEED_STATE': DataType(String), 'CDT': DataType(String), 'ATTRIBUTE_1': DataType(String), 'ATTRIBUTE_2': DataType(String), 'ATTRIBUTE_3': DataType(String), 'ATTRIBUTE_4': DataType(String), 'ATTRIBUTE_5': DataType(String), 'ATTRIBUTE_6': DataType(String), 'PLANOGRAM_DSC': DataType(String), 'PLANOGRAM_NBR': DataType(Int64), 'NEW_ITEM': DataType(Boolean), 'TO_BE_DROPPED': DataType(Boolean)}')",
                "error": "Could not coerce 'TO_BE_DROPPED' in LazyFrame with schema Schema([('PRODUCT_ID', Int64), ('CATEGORY', String), ('NEED_STATE', String), ('CDT', String), ('ATTRIBUTE_1', String), ('ATTRIBUTE_2', String), ('ATTRIBUTE_3', String), ('ATTRIBUTE_4', String), ('ATTRIBUTE_5', String), ('ATTRIBUTE_6', String), ('PLANOGRAM_DSC', String), ('PLANOGRAM_NBR', Int64), ('NEW_ITEM', Boolean), ('TO_BE_DROPPED', String)]) into type Boolean"
            }
        ]
    },
    "SCHEMA": {
        "WRONG_DATATYPE": [
            {
                "schema": "NSMappingSchema",
                "column": "TO_BE_DROPPED",
                "check": "dtype('Boolean')",
                "error": "expected column 'TO_BE_DROPPED' to have type Boolean, got String"
            }
        ]
    }
}

Stack Trace:
  File "/workspaces/testing-dagster/.venv/lib/python3.10/site-packages/dagster/_core/execution/plan/execute_plan.py", line 245, in dagster_event_sequence_for_step
    yield from check.generator(step_events)
  File "/workspaces/testing-dagster/.venv/lib/python3.10/site-packages/dagster/_core/execution/plan/execute_step.py", line 508, in core_dagster_event_sequence_for_step
    for evt in _type_check_and_store_output(step_context, user_event):
  File "/workspaces/testing-dagster/.venv/lib/python3.10/site-packages/dagster/_core/execution/plan/execute_step.py", line 552, in _type_check_and_store_output
    yield from _type_check_output(step_context, step_output_handle, output)
  File "/workspaces/testing-dagster/.venv/lib/python3.10/site-packages/dagster/_core/execution/plan/execute_step.py", line 425, in _type_check_output
    raise DagsterTypeCheckDidNotPass(
[0m
[32m2025-04-14 05:37:46 +0000[0m - dagster - [34mDEBUG[0m - internal_preprocessing_job - 92153196-eeaf-43b3-9e2b-bfef8c85a940 - 6393 - internal_raw_sales_data - STEP_START - Started execution of step "internal_raw_sales_data".
[32m2025-04-14 05:37:46 +0000[0m - dagster - [34mINFO[0m - internal_preprocessing_job - 92153196-eeaf-43b3-9e2b-bfef8c85a940 - internal_raw_sales_data - Reading need state sales data
[32m2025-04-14 05:37:46 +0000[0m - dagster - [34mINFO[0m - internal_preprocessing_job - 92153196-eeaf-43b3-9e2b-bfef8c85a940 - internal_raw_sales_data - Reader type: CSVReader
[32m2025-04-14 05:37:46 +0000[0m - dagster - [34mINFO[0m - internal_preprocessing_job - 92153196-eeaf-43b3-9e2b-bfef8c85a940 - internal_raw_sales_data - Reader attributes: {'limit': None, 'path': 'data/internal/sales_data.csv', 'delimiter': ',', 'has_header': True, 'quote_char': '"', 'ignore_errors': True, 'infer_schema_length': 10000, 'try_parse_dates': True, 'null_values': ['']}
[32m2025-04-14 05:37:46 +0000[0m - dagster - [34mINFO[0m - internal_preprocessing_job - 92153196-eeaf-43b3-9e2b-bfef8c85a940 - internal_raw_sales_data - Successfully read sales data with shape: (8, 4)
[32m2025-04-14 05:37:46 +0000[0m - dagster - [34mINFO[0m - internal_preprocessing_job - 92153196-eeaf-43b3-9e2b-bfef8c85a940 - internal_raw_sales_data - Columns: ['SKU_NBR', 'STORE_NBR', 'CAT_DSC', 'TOTAL_SALES']
[32m2025-04-14 05:37:46 +0000[0m - dagster - [34mINFO[0m - internal_preprocessing_job - 92153196-eeaf-43b3-9e2b-bfef8c85a940 - internal_raw_sales_data - Sample data: shape: (2, 4)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SKU_NBR â”† STORE_NBR â”† CAT_DSC â”† TOTAL_SALES â”‚
â”‚ ---     â”† ---       â”† ---     â”† ---         â”‚
â”‚ i64     â”† i64       â”† str     â”† str         â”‚
â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•¡
â”‚ 1001    â”† 101       â”† Grocery â”† 1250.75     â”‚
â”‚ 1002    â”† 101       â”† Grocery â”† 875.50      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
[32m2025-04-14 05:37:46 +0000[0m - dagster - [34mDEBUG[0m - internal_preprocessing_job - 92153196-eeaf-43b3-9e2b-bfef8c85a940 - 6393 - internal_raw_sales_data - STEP_OUTPUT - Yielded output "result" of type "SalesSchema". Warning! Type check failed.
[32m2025-04-14 05:37:46 +0000[0m - dagster - [34mERROR[0m - [31minternal_preprocessing_job - 92153196-eeaf-43b3-9e2b-bfef8c85a940 - 6393 - internal_raw_sales_data - STEP_FAILURE - Execution of step "internal_raw_sales_data" failed.

dagster._core.errors.DagsterTypeCheckDidNotPass: Type check failed for step output "result" - expected type "SalesSchema". Description: {
    "DATA": {
        "DATATYPE_COERCION": [
            {
                "schema": "SalesSchema",
                "column": "SalesSchema",
                "check": "coerce_dtype('{'SKU_NBR': DataType(Int64), 'STORE_NBR': DataType(Int64), 'CAT_DSC': DataType(String), 'TOTAL_SALES': DataType(Float64)}')",
                "error": "Could not coerce 'TOTAL_SALES' in LazyFrame with schema Schema([('SKU_NBR', Int64), ('STORE_NBR', Int64), ('CAT_DSC', String), ('TOTAL_SALES', String)]) into type Float64"
            }
        ],
        "CHECK_ERROR": [
            {
                "schema": "SalesSchema",
                "column": "TOTAL_SALES",
                "check": "greater_than_or_equal_to(0)",
                "error": "ComputeError(\"cannot compare string with numeric type (i32)\")"
            }
        ]
    },
    "SCHEMA": {
        "WRONG_DATATYPE": [
            {
                "schema": "SalesSchema",
                "column": "TOTAL_SALES",
                "check": "dtype('Float64')",
                "error": "expected column 'TOTAL_SALES' to have type Float64, got String"
            }
        ]
    }
}

Stack Trace:
  File "/workspaces/testing-dagster/.venv/lib/python3.10/site-packages/dagster/_core/execution/plan/execute_plan.py", line 245, in dagster_event_sequence_for_step
    yield from check.generator(step_events)
  File "/workspaces/testing-dagster/.venv/lib/python3.10/site-packages/dagster/_core/execution/plan/execute_step.py", line 508, in core_dagster_event_sequence_for_step
    for evt in _type_check_and_store_output(step_context, user_event):
  File "/workspaces/testing-dagster/.venv/lib/python3.10/site-packages/dagster/_core/execution/plan/execute_step.py", line 552, in _type_check_and_store_output
    yield from _type_check_output(step_context, step_output_handle, output)
  File "/workspaces/testing-dagster/.venv/lib/python3.10/site-packages/dagster/_core/execution/plan/execute_step.py", line 425, in _type_check_output
    raise DagsterTypeCheckDidNotPass(
[0m
[32m2025-04-14 05:37:46 +0000[0m - dagster - [34mERROR[0m - [31minternal_preprocessing_job - 92153196-eeaf-43b3-9e2b-bfef8c85a940 - internal_sales_with_categories - Dependencies for step internal_sales_with_categories failed: ['internal_product_category_mapping', 'internal_raw_sales_data']. Not executing.[0m
[32m2025-04-14 05:37:46 +0000[0m - dagster - [34mERROR[0m - [31minternal_preprocessing_job - 92153196-eeaf-43b3-9e2b-bfef8c85a940 - internal_normalized_sales_data - Dependencies for step internal_normalized_sales_data were not executed: ['internal_sales_with_categories']. Not executing.[0m
[32m2025-04-14 05:37:46 +0000[0m - dagster - [34mERROR[0m - [31minternal_preprocessing_job - 92153196-eeaf-43b3-9e2b-bfef8c85a940 - internal_sales_by_category - Dependencies for step internal_sales_by_category were not executed: ['internal_normalized_sales_data']. Not executing.[0m
[32m2025-04-14 05:37:46 +0000[0m - dagster - [34mERROR[0m - [31minternal_preprocessing_job - 92153196-eeaf-43b3-9e2b-bfef8c85a940 - internal_output_sales_table - Dependencies for step internal_output_sales_table were not executed: ['internal_sales_by_category']. Not executing.[0m
